<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2014/7 | Do la a mo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Do la a mo">
<meta property="og:url" content="http://amoamo.github.io/archives/2014/07/">
<meta property="og:site_name" content="Do la a mo">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Do la a mo">
<meta name="twitter:description">

  
    <link rel="alternative" href="/atom.xml" title="Do la a mo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Do la a mo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/www/games/flappybird.html" target="_blank">Game</a>
          <a class="main-nav-link" href="/www/demo/index.html" target="_blank">Demo</a>
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://amoamo.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-skills" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/16/skills/" class="article-date">
  <time datetime="2014-07-16T06:28:59.000Z" itemprop="datePublished">Jul 16 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/16/skills/">skills</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前端开发中小技巧和注意事项">前端开发中小技巧和注意事项</h2>
<h3 id="1、浏览器地址栏中执行js代码">1、浏览器地址栏中执行js代码</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">javascript<span class="value">:<span class="function">alert</span>(<span class="string">'hello,amo!'</span>);</span></div></pre></td></tr></table></figure>

<p>这里需要注意的是：<br>如果是拷贝一段脚本到浏览器地址栏中，如果是IE或者Chrome会自动过滤掉javascript:部分，如果要保证能被正确执行请手动添加。但是对于Firefox不会。</p>
<h3 id="2、浏览器地址栏中执行html代码">2、浏览器地址栏中执行html代码</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data:text/html,<span class="tag">&lt;<span class="title">h1</span>&gt;</span>hello,amo!<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></div></pre></td></tr></table></figure>

<p>这里需要注意的是：<br>只有在非IE内核的浏览器中才能正确显示。</p>
<h3 id="3、把浏览器当编辑器">3、把浏览器当编辑器</h3>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="typedef"><span class="keyword">data</span>:text/html, &lt;html contenteditable&gt;</span></div></pre></td></tr></table></figure>

<p>这样浏览器就变成一个编辑器了。为什么可以实现呢？这是因为H5中新加了contenteditable属性，当元素指定了该属性，内容就变得可以编辑了。</p>
<p>如果对于一个现有的页面，想要将它变成编辑器模式怎么做呢？<br>可以在控制台中输入：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.body.contenteditable = <span class="literal">true</span>;</div></pre></td></tr></table></figure>

<h3 id="4、清除浮动常用方法">4、清除浮动常用方法</h3>
<p>在网页的布局上或多或少都会使用到浮动。但是浮动往往也会产生一些副作用，最常见的便是会影响兄弟元素和父元素。所以一定要记得清除浮动。我一般用以下两种方法：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class">.con</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">1px</span> solid <span class="hexcolor">#ddd</span></span></span>;</div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> gray</span></span>;</div><div class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">10px</span> auto</span></span>;</div><div class="line">    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">500px</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.c-float</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.c-margin</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">margin-top</span>:<span class="value"> <span class="number">50px</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.c-background</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#ccc</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.clear</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">clear</span>:<span class="value"> both</span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.clearfix</span><span class="pseudo">:before</span>, <span class="class">.clearfix</span><span class="pseudo">:after</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">content</span>:<span class="value"> <span class="string">""</span></span></span>;</div><div class="line">    <span class="rule"><span class="attribute">display</span>:<span class="value"> table</span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.clearfix</span><span class="pseudo">:after</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">clear</span>:<span class="value"> both</span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.clearfix</span> <span class="rules">{</span></div><div class="line">    <span class="rule">*<span class="attribute">zoom</span>:<span class="value"> <span class="number">1</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 被浮动影响，父元素高度塌陷 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"con"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"c-float c-background"</span>&gt;</span></div><div class="line">        我设置了浮动</div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 加入一个空的div，并设置清除浮动 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"c-margin con"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"c-float c-background"</span>&gt;</span></div><div class="line">	    我设置了浮动</div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"clear"</span>&gt;</span></div><div class="line">        我清除浮动</div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 利用:after伪元素 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"c-margin con clearfix"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"c-float c-background"</span>&gt;</span></div><div class="line">	    我设置了浮动</div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure>

<p><a href="/demo/float.html">demo</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://amoamo.github.io/2014/07/16/skills/" data-id="6hlgggu8hkprkyue" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-less" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/15/less/" class="article-date">
  <time datetime="2014-07-15T09:34:04.000Z" itemprop="datePublished">Jul 15 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/15/less/">less入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Less 是一个Css 预编译器,意思指的是它可以扩展Css语言,添加功能如允许变量(variables),混合(mixins),函数(functions) 和许多其他的技术，让你的Css更具维护性，主题性，扩展性。<br>Less包含了一套自定义的语法及一个解析器，用户可以通过这些语法来编写less文件，然后调用解析器来生成相应的css文件。简单来说，less其实就是在现有css语法的基础上为它加入了程序式语言的特性。</p>
<p>Less 可运行在 Node 环境,浏览器环境和Rhino环境.同时也有3种可选工具供你编译文件和监视任何改变。</p>
<p><a href="http://lesscss.org/" target="_blank" rel="external">官网</a><br><a href="http://www.lesscss.net/" target="_blank" rel="external">中文网址</a></p>
<h3 id="一、安装">一、安装</h3>
<h4 id="1、命令行下使用">1、命令行下使用</h4>
<p>Less可以通过npm在命令行上使用，作为一个脚本文件浏览器或用于广泛的第三方工具下载。</p>
<p>因为我的电脑已经安装了node环境，所以可以直接通过npm包安装的方式来安装less。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g less</div></pre></td></tr></table></figure>

<p>完成安装之后，便可以通过lessc命令来编译less文件了。如下例：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="at_rule">@<span class="keyword">color:</span> #ccc</span>;</div><div class="line"></div><div class="line"><span class="tag">body</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> @color</span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>编译该文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lessc test.less &gt; test.css</div></pre></td></tr></table></figure>

<p>便可以得到test.css文件如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">body</span> <span class="rules">{</span></div><div class="line">  <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#ccc</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>当然lessc后也可以跟很多的参数，如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//-x表示压缩</div><div class="line">lessc -x test.less &gt; test.css</div></pre></td></tr></table></figure>

<p>更多命令可以参考 —help或者参考<a href="http://lesscss.org/usage/" target="_blank" rel="external">官网</a></p>
<h4 id="2、客户端使用">2、客户端使用</h4>
<p>在浏览器中使用less.js开发是很好的，但不推荐用于生产环境中。</p>
<p><strong>浏览器端使用是在使用LESS开发时最直观的一种方式。如果是在生产环境中，尤其是对性能要求比较高的场合，建议使用node或者其它第三方工具先编译成CSS再上线使用。</strong></p>
<p>下面看如果直接在客户端来使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 目标样式表 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet/less"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span> <span class="attribute">href</span>=<span class="value">"test.less"</span> /&gt;</span></div><div class="line"><span class="comment">&lt;!-- less文件 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"less.min.js"</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div></pre></td></tr></table></figure>

<p>这样当在浏览器中访问该页面时，less.min.js便会编译test.less并在页面head中插入相应编译后的css样式</p>
<p><strong>有两点需要特别注意:</strong></p>
<ul>
<li>确保包涵.less样式表在less.js脚本之前</li>
<li>当你引入多个.less样式表时，它们都是独立编译的。所以，在每个文件中定义的变量、混合、命名空间都不会被其它的文件共享。</li>
</ul>
<h4 id="3、在引入了GruntJs的项目中使用">3、在引入了GruntJs的项目中使用</h4>
<p>参见<a href="https://www.npmjs.org/package/grunt-contrib-less" target="_blank" rel="external">grunt-contrib-less</a></p>
<h3 id="二、语法">二、语法</h3>
<h4 id="1、变量">1、变量</h4>
<p>less允许开发者自定义变量，这样做有什么好处呢？如下例：</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@artical</span>-<span class="keyword">color</span>: #fff;</div><div class="line"><span class="variable">@title</span>-<span class="keyword">color</span>: #ccc;</div><div class="line"></div><div class="line">.con {</div><div class="line">    .con-title {</div><div class="line">        <span class="keyword">color</span>: <span class="variable">@title</span>-<span class="keyword">color</span>;</div><div class="line">    }</div><div class="line">    .con-artical {</div><div class="line">        <span class="keyword">color</span>: <span class="variable">@artical</span>-<span class="keyword">color</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>css：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class">.con</span> <span class="class">.con-title</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#ccc</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.con</span> <span class="class">.con-artical</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>不难看到，通过这种方式，可以方便对变量进行统一的管理，可以抽取公共的属性在全局进行定义，一旦涉及到修改，只需修改变量即可。此外，也可以利用这种特性，来定义主题。</p>
<p>在编程中既然有变量，那么就必定涉及到一个概念作用域。下面来看下在less中变量的作用域是怎样的。</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">color</span>: <span class="preprocessor">#fff;</span></div><div class="line">.con {</div><div class="line">    <span class="keyword">color</span>: @<span class="keyword">color</span>;</div><div class="line">    @<span class="keyword">color</span>: <span class="preprocessor">#000;</span></div><div class="line">    .con-title {</div><div class="line">        background-<span class="keyword">color</span>: @<span class="keyword">color</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class">.con</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.con</span> <span class="class">.con-title</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#000</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<h4 id="2、mixins">2、mixins</h4>
<p>在less中，mixins指在一个class中混入另一个已经定义的class。</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//定义一个样式</span></div><div class="line"><span class="class">.btn</span> {</div><div class="line">    <span class="attribute">background-color</span><span class="value">: <span class="hexcolor">#b72b25</span>;</span></div><div class="line">    <span class="attribute">color</span><span class="value">: <span class="hexcolor">#fff</span>;</span></div><div class="line">}</div><div class="line"><span class="comment">//在其他的选择器中使用</span></div><div class="line"><span class="class">.con-btns</span> {</div><div class="line">    <span class="class">.btn</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class">.con-btns</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#b72b25</span></span></span>;</div><div class="line">    <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>mixins其实就是一种规则的复用。除此之外，mixins还允许混入参数。</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//定义一个样式</span></div><div class="line">.btn(@<span class="keyword">color</span>) {</div><div class="line">    background-<span class="keyword">color</span>: @<span class="keyword">color</span>;</div><div class="line">}</div><div class="line"><span class="comment">//在其他的选择器中使用</span></div><div class="line">.con-enable=btn {</div><div class="line">    .btn(<span class="preprocessor">#b72b25);</span></div><div class="line">}</div><div class="line">.con-disable=btn {</div><div class="line">    .btn(<span class="preprocessor">#ddd);</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class">.con-enable-btn</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#b72b25</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.con-disable-btn</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#ddd</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>mixins还支持传入默认参数，如下：</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.border(<span class="variable">@w</span><span class="symbol">:</span><span class="number">1</span>px,<span class="variable">@t</span><span class="symbol">:solid</span>,<span class="variable">@c</span><span class="symbol">:</span><span class="comment">#ccc) {</span></div><div class="line">    <span class="symbol">border:</span> <span class="variable">@arguments</span>;</div><div class="line">}</div><div class="line">.detail-info {</div><div class="line">    .border(<span class="number">2</span>px,dashed,<span class="comment">#d8d8d8);</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class">.detail-info</span> <span class="rules">{</span></div><div class="line">     <span class="rule"><span class="attribute">border</span>:<span class="value"> <span class="number">2px</span> dashed <span class="hexcolor">#d8d8d8</span></span></span>;</div><div class="line"> <span class="rule">}</span></div></pre></td></tr></table></figure>

<p>在项目中为了防止选择器重名的问题，可以利用命名空间：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">#amo {</span></span></div><div class="line">    .head {}</div><div class="line">}</div><div class="line">.page-head {</div><div class="line">    #amo &gt; .head;</div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="3、嵌套">3、嵌套</h4>
<p>嵌套规则很简单，如html本身的dom层次。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"con"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"con-title"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"con-artical"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"javascript:void(0)"</span>&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure>

<p>那么less可以这样编写：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">.con {</div><div class="line">    <span class="keyword">...</span></div><div class="line">    .con-title {</div><div class="line">        <span class="keyword">...</span></div><div class="line">    }</div><div class="line">    .con-artical {</div><div class="line">        <span class="keyword">...</span></div><div class="line">        a {</div><div class="line">            <span class="keyword">...</span></div><div class="line">            &:hover { //&表示该元素如果没有&表示后代元素</div><div class="line">                <span class="keyword">...</span></div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="4、运算和函数">4、运算和函数</h4>
<p>以按钮的hover为例：</p>
<p>less:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="at_rule">@<span class="keyword">color:</span> #<span class="number">80</span>e619</span>;</div><div class="line"></div><div class="line"><span class="class">.btn</span>(<span class="at_rule">@<span class="keyword">color)</span> </span>{</div><div class="line">    <span class="tag">background-color</span>: <span class="at_rule">@<span class="keyword">color;</span></span></div><div class="line">}</div><div class="line"></div><div class="line">.enable-btn {</div><div class="line">    <span class="class">.btn</span>(<span class="at_rule">@<span class="keyword">color);</span></span></div><div class="line">    &:hover { </div><div class="line">        <span class="class">.btn</span>(<span class="tag">darken</span>(<span class="at_rule">@<span class="keyword">color,</span> <span class="number">20%</span>))</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>css:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class">.enable-btn</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#80e619</span></span></span>;</div><div class="line"><span class="rule">}</span></div><div class="line"><span class="class">.enable-btn</span><span class="pseudo">:hover</span> <span class="rules">{</span></div><div class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#4d8a0f</span></span></span>;</div><div class="line"><span class="rule">}</span></div></pre></td></tr></table></figure>

<p>这样很简单的就实现了鼠标hover到按钮上背景色变暗的效果。</p>
<p>更多功能可以参考<a href="http://lesscss.org/functions/#functions-overview" target="_blank" rel="external">function api</a></p>
<h4 id="4、注释">4、注释</h4>
<p>可采用//注释或者/<em>注释</em>/，但是在编译生成css若想保留注释必须采用css标准注释/<em>..</em>/。</p>
<h4 id="5、css3参考用例">5、css3参考用例</h4>
<ul>
<li>圆角</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class">.border-radius</span> (<span class="at_rule">@radius:<span class="preprocessor"> 5px</span>) {</span></div><div class="line">    -webkit-<span class="attribute">border-radius</span><span class="value">: @radius;</span></div><div class="line">	-moz-<span class="attribute">border-radius</span><span class="value">: @radius;</span></div><div class="line">	<span class="attribute">border-radius</span><span class="value">: @radius;</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="class">.test-div</span> {</div><div class="line">    <span class="class">.border-radius</span>(20px);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>四个角可自由定制角度</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.border-radius-custom (<span class="variable">@topleft</span><span class="symbol">:</span> <span class="number">5</span>px, <span class="variable">@topright</span><span class="symbol">:</span> <span class="number">5</span>px, <span class="variable">@bottomleft</span><span class="symbol">:</span> <span class="number">5</span>px, <span class="variable">@bottomright</span><span class="symbol">:</span> <span class="number">5</span>px) {</div><div class="line">    -webkit-border-<span class="symbol">radius:</span> <span class="variable">@topleft</span> <span class="variable">@topright</span> <span class="variable">@bottomright</span> <span class="variable">@bottomleft</span>;</div><div class="line">    -moz-border-<span class="symbol">radius:</span> <span class="variable">@topleft</span> <span class="variable">@topright</span> <span class="variable">@bottomright</span> <span class="variable">@bottomleft</span>;</div><div class="line">    border-<span class="symbol">radius:</span> <span class="variable">@topleft</span> <span class="variable">@topright</span> <span class="variable">@bottomright</span> <span class="variable">@bottomleft</span>;</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .border-radius-custom(<span class="number">20</span>px, <span class="number">20</span>px, 0px, 0px);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>阴影</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">    .box-shadow (<span class="variable">@x</span><span class="symbol">:</span> 0px, <span class="variable">@y</span><span class="symbol">:</span> <span class="number">3</span>px, <span class="variable">@blur</span><span class="symbol">:</span> <span class="number">5</span>px, <span class="variable">@alpha</span><span class="symbol">:</span> <span class="number">0</span>.<span class="number">5</span>) {</div><div class="line">    -webkit-box-<span class="symbol">shadow:</span> <span class="variable">@x</span> <span class="variable">@y</span> <span class="variable">@blur</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">@alpha</span>);</div><div class="line">    -moz-box-<span class="symbol">shadow:</span> <span class="variable">@x</span> <span class="variable">@y</span> <span class="variable">@blur</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">@alpha</span>);</div><div class="line">    box-<span class="symbol">shadow:</span> <span class="variable">@x</span> <span class="variable">@y</span> <span class="variable">@blur</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">@alpha</span>);</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .box-shadow(<span class="number">5</span>px, <span class="number">5</span>px, <span class="number">6</span>px, <span class="number">0</span>.<span class="number">3</span>);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>元素过渡效果</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">.transition (@prop: all, @time: 1s, @ease: linear) {</div><div class="line">    -<span class="ruby">webkit-<span class="symbol">transition:</span> <span class="variable">@prop</span> <span class="variable">@time</span> <span class="variable">@ease</span>;</span></div><div class="line">    -<span class="ruby">moz-<span class="symbol">transition:</span> <span class="variable">@prop</span> <span class="variable">@time</span> <span class="variable">@ease</span>;</span></div><div class="line">    -<span class="ruby">o-<span class="symbol">transition:</span> <span class="variable">@prop</span> <span class="variable">@time</span> <span class="variable">@ease</span>;</span></div><div class="line">    -<span class="ruby">ms-<span class="symbol">transition:</span> <span class="variable">@prop</span> <span class="variable">@time</span> <span class="variable">@ease</span>;</span></div><div class="line">    transition: @prop @time @ease;</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .transition(all, 0.5s, ease-in);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>旋转</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">.transform (<span class="variable">@rotate</span>: <span class="number">90</span>deg, <span class="variable">@scale</span>: <span class="number">1</span>, <span class="variable">@skew</span>: <span class="number">1</span>deg, <span class="variable">@translate</span>: <span class="number">10</span>px) {</div><div class="line">    -webkit-transform: <span class="keyword">rotate</span>(<span class="variable">@rotate</span>) <span class="keyword">scale</span>(<span class="variable">@scale</span>) skew(<span class="variable">@skew</span>) translate(<span class="variable">@translate</span>);</div><div class="line">    -moz-transform: <span class="keyword">rotate</span>(<span class="variable">@rotate</span>) <span class="keyword">scale</span>(<span class="variable">@scale</span>) skew(<span class="variable">@skew</span>) translate(<span class="variable">@translate</span>);</div><div class="line">    -o-transform: <span class="keyword">rotate</span>(<span class="variable">@rotate</span>) <span class="keyword">scale</span>(<span class="variable">@scale</span>) skew(<span class="variable">@skew</span>) translate(<span class="variable">@translate</span>);</div><div class="line">    -ms-transform: <span class="keyword">rotate</span>(<span class="variable">@rotate</span>) <span class="keyword">scale</span>(<span class="variable">@scale</span>) skew(<span class="variable">@skew</span>) translate(<span class="variable">@translate</span>);</div><div class="line">    transform: <span class="keyword">rotate</span>(<span class="variable">@rotate</span>) <span class="keyword">scale</span>(<span class="variable">@scale</span>) skew(<span class="variable">@skew</span>) translate(<span class="variable">@translate</span>);</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .transform(<span class="number">5</span>deg, <span class="number">0.5</span>, <span class="number">1</span>deg, <span class="number">0</span>px);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>颜色渐变</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*线性渐变*/</span></div><div class="line">.gradient (<span class="variable">@origin</span>: left, <span class="variable">@start</span>: #ffffff, <span class="variable">@stop</span>: #<span class="number">000000</span>) {</div><div class="line">    background-<span class="keyword">color</span>: <span class="variable">@start</span>;</div><div class="line">    background-<span class="keyword">image</span>: -webkit-linear-gradient(<span class="variable">@origin</span>, <span class="variable">@start</span>, <span class="variable">@stop</span>);</div><div class="line">    background-<span class="keyword">image</span>: -moz-linear-gradient(<span class="variable">@origin</span>, <span class="variable">@start</span>, <span class="variable">@stop</span>);</div><div class="line">    background-<span class="keyword">image</span>: -o-linear-gradient(<span class="variable">@origin</span>, <span class="variable">@start</span>, <span class="variable">@stop</span>);</div><div class="line">    background-<span class="keyword">image</span>: -ms-linear-gradient(<span class="variable">@origin</span>, <span class="variable">@start</span>, <span class="variable">@stop</span>);</div><div class="line">    background-<span class="keyword">image</span>: linear-gradient(<span class="variable">@origin</span>, <span class="variable">@start</span>, <span class="variable">@stop</span>);</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .gradient(left, #<span class="number">663333</span>, #<span class="number">333333</span>);</div><div class="line">}</div></pre></td></tr></table></figure>



<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*快速渐变*/</span></div><div class="line"><span class="class">.quick-gradient</span> (<span class="at_rule">@origin:<span class="preprocessor"> left</span>, @alpha:<span class="preprocessor"> 0.2</span>) {</span></div><div class="line">    <span class="attribute">background-image</span><span class="value">: <span class="function">-webkit-linear-gradient</span>(@origin, <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.0</span>), <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,@alpha));</span></div><div class="line">    <span class="attribute">background-image</span><span class="value">: <span class="function">-moz-linear-gradient</span>(@origin, <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.0</span>), <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,@alpha));</span></div><div class="line">    <span class="attribute">background-image</span><span class="value">: <span class="function">-o-linear-gradient</span>(@origin, <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.0</span>), <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,@alpha));</span></div><div class="line">    <span class="attribute">background-image</span><span class="value">: <span class="function">-ms-linear-gradient</span>(@origin, <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.0</span>), <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,@alpha));</span></div><div class="line">    <span class="attribute">background-image</span><span class="value">: <span class="function">linear-gradient</span>(@origin, <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.0</span>), <span class="function">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,@alpha));</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="class">.test-div</span> {</div><div class="line">    <span class="attribute">background-color</span><span class="value">: <span class="hexcolor">#bada55</span>;</span></div><div class="line">    <span class="class">.quick-gradient</span>(<span class="attribute">top</span>, 0<span class="class">.2</span>);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>镜像</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.reflect (<span class="variable">@length</span>: <span class="number">50</span><span class="variable">%,</span> <span class="variable">@opacity</span>: <span class="number">0.2</span>){</div><div class="line">    -webkit-box-reflect: below <span class="number">0</span>px -webkit-gradient(linear, left top, left bottom, from(transparent),</div><div class="line">    <span class="keyword">color</span>-stop(<span class="variable">@length</span>, transparent), to(rgba(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="variable">@opacity</span>)));</div><div class="line">}</div><div class="line"></div><div class="line">.test-div {</div><div class="line">    .reflect(<span class="number">20</span><span class="variable">%,</span> <span class="number">0.2</span>);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>颜色</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*互补色*/</span></div><div class="line"><span class="at_rule">@<span class="keyword">base:</span> #<span class="number">663333</span></span>;</div><div class="line"><span class="at_rule">@<span class="keyword">complement1:</span> <span class="function">spin</span>(@base, <span class="number">180</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">complement2:</span> <span class="function">darken</span>(<span class="function">spin</span>(@base, <span class="number">180</span>), <span class="number">5%</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">lighten1:</span> <span class="function">lighten</span>(@base, <span class="number">15%</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">lighten2:</span> <span class="function">lighten</span>(@base, <span class="number">30%</span>)</span>;</div><div class="line"></div><div class="line"><span class="class">.one</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @base</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.two</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @complement1</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.three</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @complement2</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.four</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @lighten1</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.five</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @lighten2</span></span>;<span class="rule">}</span></span></div></pre></td></tr></table></figure>



<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*颜色微调*/</span></div><div class="line"><span class="at_rule">@<span class="keyword">base:</span> #<span class="number">663333</span></span>;</div><div class="line"><span class="at_rule">@<span class="keyword">lighter1:</span> <span class="function">lighten</span>(<span class="function">spin</span>(@base, <span class="number">5</span>), <span class="number">10%</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">lighter2:</span> <span class="function">lighten</span>(<span class="function">spin</span>(@base, <span class="number">10</span>), <span class="number">20%</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">darker1:</span> <span class="function">darken</span>(<span class="function">spin</span>(@base, -<span class="number">5</span>), <span class="number">10%</span>)</span>;</div><div class="line"><span class="at_rule">@<span class="keyword">darker2:</span> <span class="function">darken</span>(<span class="function">spin</span>(@base, -<span class="number">10</span>), <span class="number">20%</span>)</span>;</div><div class="line"></div><div class="line"><span class="class">.one</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @base</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.two</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @lighter1</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.three</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @lighter2</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.four</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @darker1</span></span>;<span class="rule">}</span></span></div><div class="line"><span class="class">.five</span> <span class="rules">{<span class="rule"><span class="attribute">color</span>:<span class="value"> @darker2</span></span>;<span class="rule">}</span></span></div></pre></td></tr></table></figure>

<p>也可以参考<br><a href="https://github.com/zzyss86/LESS-CSS3/blob/master/css3.less" target="_blank" rel="external">css3预处理工具</a><br><a href="https://github.com/dmitryf/elements" target="_blank" rel="external">useful mixins</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://amoamo.github.io/2014/07/15/less/" data-id="m7btvlwd2pagqen7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/less-css/">less css</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-console" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/04/console/" class="article-date">
  <time datetime="2014-07-04T08:18:08.000Z" itemprop="datePublished">Jul 4 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/04/console/">console使用小技巧</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>作为一个前端开发者，可能每天都会用到console对象的方法进行调试等，但是你真的了解console么？什么是console呢？</p>
<p>最初，console是firebug提供的一个内置对象，它可以用于我们跟踪调试在网页加载过程中的各类信息。</p>
<p>那么我们首先来看下它的基本用法。</p>
<h3 id="一、基本用法">一、基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.log(<span class="string">"log info"</span>);</div></pre></td></tr></table></figure>

<p>根据信息的不同性质，console对象还有4种显示信息的方法，分别是：</p>
<ul>
<li>一般信息console.info()</li>
<li>出错信息console.debug()</li>
<li>警告提示console.warn()</li>
<li>错误提示console.error()</li>
</ul>
<p><img src="/css/images/console_0.jpg" alt=""></p>
<h3 id="二、格式化输出">二、格式化输出</h3>
<p>console对象支持类似于C语言printf占位符写法的输出，一些复杂的输出利用这种方法可以让结构更加的清晰。</p>
<p>先看一个例子:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.log(<span class="string">'%d + %d = %d'</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>);</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_1.jpg" alt=""></p>
<p>console支持的占位符格式有如下几种：</p>
<ul>
<li><p>%s      :   字符串</p>
</li>
<li><p>%d / %i ：  整数</p>
</li>
<li><p>%f      ： 浮点数</p>
</li>
<li><p>%o / %O ： 对象，可以用来查看一个对象内部的情况。虽然对于普通对象这两者打印出来的信息是一样的，但是需要注意的是，在Chrome控制台中打印的如果是一个dom节点，那么此时二者是有区别的，%o打印的为和非格式化输出的结果一样，包括节点、内容、子节点等，但是对于%O来说，打印的是dom节点中各个对象的属性。</p>
</li>
<li><p>%c      ： css样式</p>
</li>
</ul>
<p>下面我们来看几个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//chrome中</div><div class="line">console.log(<span class="string">"%O"</span>,  document.body);</div><div class="line">console.log(<span class="string">"%o"</span>,  document.body);</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_2.jpg" alt=""></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.log(<span class="string">"%c%s %chas %d fingers"</span>, <span class="string">"color:green;text-shadow:1px 1px 1px rgba(0,0,0,.2); font-size: 16pt"</span>, <span class="string">"amo"</span>, <span class="string">"color: #333333; font-size: 16pt"</span>, <span class="number">10</span>);</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_3.jpg" alt=""></p>
<p>原来在控制台里还可以进行样式的控制，是不是很有趣？<strong>但是对于IE并不支持样式，所以注意哦</strong>既然可以加样式，自然而然就会问，那能不能进行图片的输出呢，答案是否定的（firefox提供console.image插件），可是我们可以通过背景图的方式来进行图片的输出。只是这里的图片大小需要通过padding和line-height来控制。用的时候请谨慎调节(chrome下生效)。</p>
<p>看个例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//chrome</div><div class="line">console.log(<span class="string">"%c"</span>, <span class="string">"padding: 80px 100px;height:1px; background:url(http://p1.gexing.com/G1/M00/24/A6/rBACFFH2hjPAQgmdAAAVighCO6A353_200x200_3.jpg);line-height:200px"</span>);</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_4.jpg" alt=""></p>
<h3 id="三、分组输出">三、分组输出</h3>
<p>如果需要打印较多的信息，可以利用分组输出进行结构化的管理。console.group()定义组的开始，console.groupEnd()定义组的结束。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">console.group(<span class="string">"amo"</span>);</div><div class="line">console.log(<span class="string">"a's hand"</span>);</div><div class="line">console.log(<span class="string">"a's work"</span>);</div><div class="line">console.groupEnd();</div><div class="line"></div><div class="line">console.group(<span class="string">"zicheng"</span>);</div><div class="line">console.log(<span class="string">"z's hand"</span>);</div><div class="line">console.log(<span class="string">"z's work"</span>);</div><div class="line">console.groupEnd();</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_5.jpg" alt=""></p>
<h3 id="四、其他用法">四、其他用法</h3>
<ul>
<li>console.dir()显示一个对象所有的属性和方法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var cat = {<span class="string">"eyes"</span>: <span class="number">2</span>, <span class="string">"ears"</span>: <span class="number">2</span>, <span class="string">"sayHi"</span>: <span class="function"><span class="title">function</span></span>(){ <span class="keyword">return</span> <span class="string">"miao~"</span>; }};</div><div class="line">console.dir(cat);</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_6.jpg" alt=""></p>
<ul>
<li><p>console.trace()追踪函数调用时的栈信息</p>
</li>
<li><p>计时功能</p>
</li>
</ul>
<p>console.time()和console.timeEnd()，利用它们分别在代码执行开始和结束时打上标识，以用来显示代码的运行时间。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">console.time(<span class="string">"for"</span>);</div><div class="line"><span class="keyword">for</span>(var i=<span class="number">0</span>;i&lt;<span class="number">1000</span>;i++){</div><div class="line">    <span class="keyword">for</span>(var j=<span class="number">0</span>;j&lt;<span class="number">1000</span>;j++){}</div><div class="line">}</div><div class="line">console.timeEnd(<span class="string">"for"</span>); //<span class="keyword">for</span>: <span class="number">3.000</span>ms</div></pre></td></tr></table></figure>

<ul>
<li>计数器</li>
</ul>
<p>console.count()，用于记录函数被调用的次数统计，在某些复杂场景的调试中很有用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function login(user) {</div><div class="line">    console.count(<span class="string">"Login called for user '"</span> +  user + <span class="string">"'"</span>);</div><div class="line">}</div><div class="line">login(<span class="string">"amo"</span>); //Login called <span class="keyword">for</span> user <span class="string">'amo'</span>: <span class="number">1</span></div><div class="line">login(<span class="string">"zicheng"</span>); //Login called <span class="keyword">for</span> user <span class="string">'zicheng'</span>: <span class="number">1</span></div></pre></td></tr></table></figure>

<ul>
<li>性能分析</li>
</ul>
<p>console.profile()，可以帮助我们进行性能分析，找出瓶颈。（firefox有效）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">function <span class="function"><span class="title">Foo</span></span>(){</div><div class="line">    <span class="keyword">for</span>(var i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++){</div><div class="line">        funcA(<span class="number">1000</span>);</div><div class="line">    }</div><div class="line">    funcB(<span class="number">10000</span>);</div><div class="line">}</div><div class="line">function funcA(count){</div><div class="line">　　 <span class="keyword">for</span>(var i=<span class="number">0</span>;i&lt;count;i++){}</div><div class="line">}</div><div class="line">function funcB(count){</div><div class="line"> 　　<span class="keyword">for</span>(var i=<span class="number">0</span>;i&lt;count;i++){}</div><div class="line">}</div><div class="line">console.profile(<span class="string">'profile'</span>);</div><div class="line">Foo();</div><div class="line">console.profileEnd();</div></pre></td></tr></table></figure>

<p><img src="/css/images/console_7.jpg" alt=""></p>
<p>由上图可以看到各个函数执行的情况。</p>
<ul>
<li>清空所有调试信息</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.clear();</div></pre></td></tr></table></figure>

<h3 id="需要注意的是浏览器兼容性">需要注意的是浏览器兼容性</h3>
<p>对于IE较老版本，或者是某些属性，并不是所有浏览器都兼容的，所以调试信息请尽量在开发时使用，并不要带到线上。但是我们也看到有些网站会将招聘信息通过console.log()的方式输出到控制台中，这个时候就要注意做好兼容。以下为腾讯所做的处理，仅供参考。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="title">function</span></span>(){</div><div class="line">    <span class="keyword">if</span>(!console || !console.log){</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    }</div><div class="line">    var toFixedVersion = function(ver, floatLength){</div><div class="line">        ver= (<span class="string">""</span>+ver).replace(/_/g,<span class="string">"."</span>);</div><div class="line">        floatLength = floatLength || <span class="number">1</span>;</div><div class="line">        ver = String(ver).split(<span class="string">"."</span>);</div><div class="line">        ver = ver[<span class="number">0</span>] + <span class="string">"."</span> + (ver[<span class="number">1</span>] || <span class="string">"0"</span>);</div><div class="line">        ver = Number(ver).toFixed(floatLength);</div><div class="line">        <span class="keyword">return</span> ver;</div><div class="line">    };</div><div class="line">    var ua = navigator.userAgent.toLowerCase(),</div><div class="line">    browserName,</div><div class="line">    browserVer,</div><div class="line">    s;</div><div class="line">    var <span class="keyword">set</span>Ver = function(name, ver){</div><div class="line">        browserName = name;</div><div class="line">        browserVer = ver;</div><div class="line">    };</div><div class="line">    (s = ua.match(/chrome\/([\d]+)/)) ? <span class="keyword">set</span>Ver(<span class="string">"chrome"</span>,toFixedVersion(s[<span class="number">1</span>])) : <span class="number">0</span>;</div><div class="line">    var isSupport = (browserName === <span class="string">'chrome'</span> && browserVer &gt;= <span class="number">25</span>);</div><div class="line">    <span class="keyword">if</span>(isSupport){</div><div class="line">        var imgList = [];</div><div class="line">        <span class="keyword">for</span>(var i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++){</div><div class="line">            imgList.push(<span class="string">'padding:49px 55.5px;line-height:111px;background:url(http://codestar.alloyteam.com/1/style/image/beauty'</span> + (i+<span class="number">1</span>) +   <span class="string">'.jpg) no-repeat;'</span>);</div><div class="line">        }</div><div class="line">        console.log(<span class="string">'%c云云无情，腾腾有爱'</span>, <span class="string">'font-size:18px;text-shadow: rgb(153, 153, 153) 2px 2px 2px;font-weight:bold;line-height:1.8;font  -family:"微软雅黑"'</span>);</div><div class="line">        console.log(<span class="string">'%c'</span>, imgList[Math.round(Math.random()*(imgList.length-<span class="number">1</span>))]);</div><div class="line">        console.log(<span class="string">'%c如果你没有100个“往来”好友，那就来腾讯领红包吧！红包精彩，腾讯更精彩！'</span>, <span class="string">'color:#08c;'</span>);</div><div class="line">        console.log(<span class="string">'http://www.ipresst.com/jointencent'</span>);</div><div class="line">        console.log(<span class="string">'\n-------------华丽的分割线-------------\n'</span>);</div><div class="line">        console.log(<span class="string">'%c【前端特工】\n“据内线消息，TX公司将于近期推出一个新的HTML5重磅产品。\n公司担心该产品会带来威胁，特命你潜入TX，探查底细  ……”\nhttp://codestar.alloyteam.com\n\n'</span>, <span class="string">'line-height:1.8;'</span>);</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        console.log(<span class="string">'【云云无情，腾腾有爱】\n如果你没有100个“往来”好友，那就来腾讯领红包吧！红包精彩，腾讯更精彩！\nhttp://www.ipresst.com/jo  intencent'</span>);</div><div class="line">        console.log(<span class="string">'\n-------------华丽的分割线-------------\n'</span>);</div><div class="line">        console.log(<span class="string">'【前端特工】\n“据内线消息，TX公司将于近期推出一个新的HTML5重磅产品。\n公司担心该产品会带来威胁，特命你潜入TX，探查底细……  ”\nhttp://codestar.alloyteam.com\n\n'</span>);</div><div class="line">    }</div><div class="line">})();</div></pre></td></tr></table></figure>

<h3 id="参考资料">参考资料</h3>
<p><a href="https://developers.google.com/chrome-developer-tools/docs/console-api" target="_blank" rel="external">console-api</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://amoamo.github.io/2014/07/04/console/" data-id="sgmiv8xuvgjyx1wd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-cross_domain" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/01/cross_domain/" class="article-date">
  <time datetime="2014-07-01T06:50:41.000Z" itemprop="datePublished">Jul 1 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/javascript/">javascript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/01/cross_domain/">跨域问题及解决方案</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>说到javascript跨越问题，首页必然需要引入一个概念。那就是为什么会存在跨域问题？又该如何解决呢？</p>
<h3 id="一、同源策略（same-origin_policy）">一、同源策略（same-origin policy）</h3>
<p>在web应用安全模型里同源策略是一个很重要的概念。它是由Netscape提出的一个著名的安全策略，现在所有的可支持javascript的浏览器都会使用这个策略。</p>
<p>同源策略，又称为单源策略，它限制了一个源（origin）中加载文本或脚本与来自其它源（origin）中资源的交互方式。</p>
<p>Mozilla认为两个页面它们拥有相同的协议、端口（如果指明）、主机名，那么这两个页面就拥有相同的源。</p>
<p>下面来看一个例子，假设有一个url地址为: <a href="http://www.a.com/page/a.html的同源检测示例：" target="_blank" rel="external">http://www.a.com/page/a.html的同源检测示例：</a></p>
<table>
<thead>
<tr>
<th>URL</th>
<th style="text-align:center">非IE浏览器结果</th>
<th style="text-align:center">IE浏览器结果</th>
<th style="text-align:center">原因</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://www.a.com/page/b.html" target="_blank" rel="external">http://www.a.com/page/b.html</a></td>
<td style="text-align:center">成功</td>
<td style="text-align:center">成功</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td><a href="http://www.a.com/app/c.html" target="_blank" rel="external">http://www.a.com/app/c.html</a></td>
<td style="text-align:center">成功</td>
<td style="text-align:center">成功</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td><a href="http://username:password@www.a.com/page/b.html" target="_blank" rel="external">http://username:password@www.a.com/page/b.html</a></td>
<td style="text-align:center">成功</td>
<td style="text-align:center">成功</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td><a href="http://www.a.com:81/page/d.html" target="_blank" rel="external">http://www.a.com:81/page/d.html</a></td>
<td style="text-align:center">失败</td>
<td style="text-align:center">成功</td>
<td style="text-align:center">端口不同</td>
</tr>
<tr>
<td><a href="https://www.a.com/page/e.html" target="_blank" rel="external">https://www.a.com/page/e.html</a></td>
<td style="text-align:center">失败</td>
<td style="text-align:center">失败</td>
<td style="text-align:center">协议不同</td>
</tr>
<tr>
<td><a href="http://www.b.a.com/page/c.html" target="_blank" rel="external">http://www.b.a.com/page/c.html</a></td>
<td style="text-align:center">失败</td>
<td style="text-align:center">失败</td>
<td style="text-align:center">主机不同</td>
</tr>
<tr>
<td><a href="http://www.c.com/page/c.html" target="_blank" rel="external">http://www.c.com/page/c.html</a></td>
<td style="text-align:center">失败</td>
<td style="text-align:center">失败</td>
<td style="text-align:center">主域不同</td>
</tr>
</tbody>
</table>
<p>从上表不难看出，对于IE来说在处理同源策略上有一些不同：</p>
<p><strong>1、端口:IE未将端口号加入到同源策略的组成部分之中，因此 <a href="http://a.com:81/index.html" target="_blank" rel="external">http://a.com:81/index.html</a> 和<a href="http://a.com/index.html" target="_blank" rel="external">http://a.com/index.html</a>  属于同源并且不受任何限制。</strong></p>
<p><strong>2、授信范围（Trust Zones）：两个相互之间高度互信的域名，如公司域名（corporate domains），不遵守同源策略的限制。</strong></p>
<p>除这些指定的URL之外，也常常会有来自about:blank，javascript:和data:URLs中的内容，它们遵循源继承的原则，继承将其载入的文档所指定的源，因为它们的URL本身未指定任何关于自身源的信息。</p>
<h3 id="二、Javascript跨域解决方案">二、Javascript跨域解决方案</h3>
<h4 id="1、设置Domain">1、设置Domain</h4>
<p>页面可以改变本身的源，但会受到一些限制。脚本可以设置document.domain 的值为当前域的一个后缀</p>
<p>在同源策略中有一个例外，脚本可以设置 document.domain 的值为当前域的一个后缀，如果这样做的话，短的域将作为后续同源检测的依据。例如，假设在 <a href="http://b.a.com/page/a.html" target="_blank" rel="external">http://b.a.com/page/a.html</a> 中的一个脚本执行了下列语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.domain = <span class="string">"a.com"</span></div></pre></td></tr></table></figure>

<p>这条语句执行之后，页面将会成功地通过对 <a href="http://a.com/page/a.html" target="_blank" rel="external">http://a.com/page/a.html</a> 的同源检测。而同理，a.com 不能设置 document.domain 为 b.com.</p>
<p>浏览器单独保存端口号。任何的赋值操作，包括document.domain = documen.domain都会以null值覆盖掉原来的端口号。因此a.com:8080页面的脚本不能仅通过设置document.domain = “a.com”就能与company.com通信。赋值时必须带上端口号，以确保端口号不会为null。</p>
<p><strong>注意：使用document.domain来安全是让子域访问其父域，需要同时将子域和父域的document.domain设置为相同的值。必须要这么做，即使是简单的将父域设置为其原来的值。没有这么做的话可能导致授权错误。</strong></p>
<ul>
<li><p>举个例子</p>
<p>  a.taobao.com嵌入一个b.taobao.com的页面，并且需要做高度自适应，那么可以这么来做：</p>
<ul>
<li>在a页面中设置domain并定义autoHeight方法（用处为改变iframe的高度）</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.domain = <span class="string">"taobao.com"</span></div></pre></td></tr></table></figure>


<pre><code><span class="deletion">- 在b页面,页面加载之后或者所有涉及到高度变化的事件中，调用a页面的方法：</span>
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function <span class="function"><span class="title">fixHeight</span></span>(){</div><div class="line">	document.domain = <span class="string">'taobao.com'</span>;</div><div class="line">	var oHeight = document.documentElement.scrollHeight;</div><div class="line">	window.parent.autoHeight(oHeight); //调用a页面的autoHeight方法，在该方法中去改变iframe的高度</div><div class="line">}</div></pre></td></tr></table></figure>

<h4 id="2、使用代理页">2、使用代理页</h4>
<p>如果主域名也不同该怎么做呢？如：a.com/index.html和b.com/iframe.html</p>
<ul>
<li><p>有一种办法是采用<strong>代理页</strong>的方式</p>
<p>  即在b.com下建立一个b.com/proxy.html代理页面，还是以高度自适应为例来说明：</p>
<p>  a页面iframe该proxy页面，并将高度以hash值的方式填到这个嵌入proxy.html的iframe的src中去<br>  在proxy.html中去拿到这个hash中的高度值，并去操作父父层页面的高度<br>  <img src="/css/images/iframe.png" alt="iframe cross domain"></p>
<p>  代码如下：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#set_height.js</span></div><div class="line">(function(win, doc){</div><div class="line">	win.onload = <span class="function"><span class="title">function</span></span> () {</div><div class="line">        var url = <span class="string">"http://a.com/proxy.html"</span>;</div><div class="line">       	var ifmProxy = doc.getElementById(<span class="string">"ifmProxy"</span>); //iframe target</div><div class="line">        var hs; //height</div><div class="line">        var hsLastTime = <span class="number">0</span>; //height last time</div><div class="line">        var startTime = <span class="number">0</span>; //count</div><div class="line">        var loadIframeStart = win.setInterval( <span class="function"><span class="title">function</span></span> () {</div><div class="line">            <span class="keyword">set</span>Height();</div><div class="line">        }, <span class="number">500</span>);</div><div class="line">        function <span class="function"><span class="title">setHeight</span></span>() {</div><div class="line">            startTime++;</div><div class="line">            //get current height</div><div class="line">            hs = doc.documentElement.scrollHeight;</div><div class="line">            //update the hs height</div><div class="line">            <span class="keyword">if</span>(hs !== hsLastTime) {</div><div class="line">            	ifmProxy.src = url + <span class="string">"#"</span> + hs;</div><div class="line">                hsLastTime = hs;</div><div class="line">            }</div><div class="line">            //clearCount and restart</div><div class="line">         	<span class="keyword">if</span>(startTime &gt;= <span class="number">500</span>) {</div><div class="line">         	    clearInterval(loadIframeStart);</div><div class="line">               	startTime = <span class="number">0</span>;</div><div class="line">               	loadIframeStart = win.setInterval( <span class="function"><span class="title">function</span></span>() {</div><div class="line">                    <span class="keyword">set</span>Height();</div><div class="line">               	}, <span class="number">500</span>)                                                                            </div><div class="line">            }    </div><div class="line">        }</div><div class="line">    };</div><div class="line">})(window, document);</div></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#proxy.html</span></div><div class="line">&lt;script&gt;</div><div class="line">    try{</div><div class="line">        var ifmAnalyst = parent.parent.document.getElementById(<span class="string">'isvIframeCon'</span>); //目标iframe</div><div class="line">        var hs; //获取的高度</div><div class="line">        var hsLastTime = <span class="number">0</span>; //上一次获取到的高度</div><div class="line">        var startTime = <span class="number">0</span>; //计时器初始值</div><div class="line">        var loadIframeStart = window.setInterval( <span class="function"><span class="title">function</span></span> () {</div><div class="line">            updateHeight();</div><div class="line">        }, <span class="number">500</span>);</div><div class="line">        function <span class="function"><span class="title">updateHeight</span></span>() {</div><div class="line">            startTime++;</div><div class="line">            //获取当前的高度值</div><div class="line">            hs = window.location.hash;</div><div class="line">            //当高度改变则去更新iframe的高度同时将hsLastTime更新</div><div class="line">            <span class="keyword">if</span>(hs !== hsLastTime) {</div><div class="line">                ifmAnalyst.style.height = hs.split(<span class="string">"#"</span>)[<span class="number">1</span>] + <span class="string">"px"</span>;</div><div class="line">                hsLastTime = hs;</div><div class="line">            }</div><div class="line">            //当达到一定的次数，清理一次计时器，并重新开始监听</div><div class="line">            <span class="keyword">if</span>(startTime &gt;= <span class="number">500</span>) {</div><div class="line">                clearInterval(loadIframeStart);</div><div class="line">                startTime = <span class="number">0</span>;</div><div class="line">                loadIframeStart = window.setInterval( <span class="function"><span class="title">function</span></span>() {</div><div class="line">                    updateHeight();</div><div class="line">                }, <span class="number">500</span>)</div><div class="line">            }                                                                                      </div><div class="line">        }</div><div class="line">    } catch(ex) {</div><div class="line">    }</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>

<h4 id="3、JSONP（创建script标签形式）">3、JSONP（创建script标签形式）</h4>
<p>所谓JSONP的方式简单来说就是利用script标签不受同源策略的限制这一特性。</p>
<p>我们通过script标签的形式把想要请求的地址作为src传入，从而获得相应的文件或者JSON数据。</p>
<p>a.com下的数据fn({“name”: “amo”});</p>
<p>b.com下的函数function fn(res){ console.log(res.name); }</p>
<p>下面我们来看下具体来写应该怎样做：</p>
<ul>
<li>在A.com网站下：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function createJs(sUrl){</div><div class="line">    var oScript = document.createElement(<span class="string">'script'</span>);</div><div class="line">    oScript.type = <span class="string">'text/javascript'</span>;</div><div class="line">    oScript.src = sUrl;</div><div class="line">    document.getElementByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(oScript);</div><div class="line">}</div><div class="line">createJs(<span class="string">'jsonp.js?callback=fn'</span>);</div><div class="line">function fn(rs) {</div><div class="line">    console.log(rs);</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li>在B.com的jsonp.js通过拿到这个callback参数，并把它填充到具体的数据中，格式如下</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fn({<span class="string">"name"</span>, <span class="string">"amo"</span>});</div></pre></td></tr></table></figure>


<pre><code>这样就相当于页面上是这样的
</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">	fn({<span class="string">"name"</span>: <span class="string">"amo"</span>});//fn这个函数的调用</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>

<p>当然这里只是一个思路的过程，实际JSONP的过程要比这复杂的多，比如说是否onload、回调状态码、格式的校验等。</p>
<h4 id="4、postMessage方式">4、postMessage方式</h4>
<p>在HTML5中，提出了工作线程的概念（web workers）。Web Workers 允许开发人员编写能够长时间运行而不被用户所中断的后台程序，去执行事务或者逻辑，并同时保证页面对用户的及时响应。web worker一旦被创建，就可以通过postMessage 向任务池发送任务请求，执行完之后再通过 postMessage 返回消息给创建者指定的事件处理程序 ( 通过 onmessage 进行捕获 )。Web Workers 进程能够在不影响用户界面的情况下处理任务，并且，它还可以使用 XMLHttpRequest 来处理 I/O，但通常，后台进程（包括 Web Workers 进程）不能对 DOM 进行操作。如果希望后台程序处理的结果能够改变 DOM，只能通过返回消息给创建者的回调函数进行处理。 </p>
<p>那么利用这个特性，我们怎么来实现跨域之间的通信呢？还是以高度自适应为例。</p>
<p>a.com/parent.html 嵌入 b.com/child.html该如何去获取到b下面的页面高度呢？</p>
<p>在child.html中引入如下代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">(function(win, doc){</div><div class="line">    win.onload = <span class="function"><span class="title">function</span></span> () {</div><div class="line">        var hs; //height</div><div class="line">        var hsLastTime = <span class="number">0</span>; //height last time</div><div class="line">        var startTime = <span class="number">0</span>; //count</div><div class="line">        var loadIframeStart = win.setInterval( <span class="function"><span class="title">function</span></span> () {</div><div class="line">            <span class="keyword">set</span>Height();</div><div class="line">        }, <span class="number">500</span>);</div><div class="line">        function <span class="function"><span class="title">setHeight</span></span>() {</div><div class="line">            startTime++;</div><div class="line">            //get current height</div><div class="line">            hs = doc.documentElement.offsetHeight;</div><div class="line">            //update the hs height</div><div class="line">            <span class="keyword">if</span>(hs !== hsLastTime) {</div><div class="line">                window.parent.postMessage({h: hs}, <span class="string">'*'</span>); //指定是向父容器postmessage</div><div class="line">                hsLastTime = hs;</div><div class="line">            }</div><div class="line">            //clearCount and restart</div><div class="line">            <span class="keyword">if</span>(startTime &gt;= <span class="number">500</span>) {</div><div class="line">                clearInterval(loadIframeStart);</div><div class="line">                startTime = <span class="number">0</span>;</div><div class="line">                loadIframeStart = win.setInterval( <span class="function"><span class="title">function</span></span>() {</div><div class="line">                    <span class="keyword">set</span>Height();</div><div class="line">                }, <span class="number">500</span>)</div><div class="line">            }</div><div class="line">        }</div><div class="line">    };</div><div class="line">})(window, document);</div></pre></td></tr></table></figure>

<p>在parent.html加载完iframe之后引入如下代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">window.addEventListener(<span class="string">"message"</span>, function(data) {</div><div class="line">    var ifmAnalyst = document.getElementById(<span class="string">'isvIframeCon'</span>)，//目标iframe</div><div class="line">        ifmHeight = data.data.h;</div><div class="line">    //data.data.h即为高度</div><div class="line">    ifmAnalyst.style.height = ifmHeight + <span class="string">"px"</span>;</div><div class="line">});</div></pre></td></tr></table></figure>

<p><strong>这种方法虽然很方便，但是是H5的特性，所以在使用前先考虑是否需要兼容低版本浏览器</strong></p>
<h4 id="5、服务器代理">5、服务器代理</h4>
<h4 id="6、flash方式">6、flash方式</h4>
<p>后两种方式，这里不做介绍。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://amoamo.github.io/2014/07/01/cross_domain/" data-id="vcnhykck4vtv2zlg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cross-domain/">cross domain</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cross-domain/">cross domain</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/less-css/">less css</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/cross-domain/" style="font-size: 10.00px;">cross domain</a><a href="/tags/css/" style="font-size: 20.00px;">css</a><a href="/tags/less-css/" style="font-size: 10.00px;">less css</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11">November 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08">August 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07">July 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06">June 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2014/11/12/clip/">clip用法</a>
          </li>
        
          <li>
            <a href="/2014/08/06/css_selector/">css选择器</a>
          </li>
        
          <li>
            <a href="/2014/07/16/skills/">skills</a>
          </li>
        
          <li>
            <a href="/2014/07/15/less/">less入门</a>
          </li>
        
          <li>
            <a href="/2014/07/04/console/">console使用小技巧</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2014 Do la a mo<br>
      Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>